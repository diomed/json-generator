<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>json generator</title>

    <link rel="icon" type="image/png" href="css/favicon.png" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.26.12/dist/sweetalert2.all.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body>
    <div class="app">
      <div class="h-full flex justify-center items-center">
        <div
          class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 flex flex-col my-2 eo"
        >
          <form id="myForm">
            <div class="-mx-3 md:flex mb-6 flex-wrap">
              <div class="md:w-full px-3 mb-6 md:mb-0">
                <label
                  class="block uppercase tracking-wide text-blue-darker text-xs font-bold mb-2"
                  for="grid-last-name"
                  >English</label
                >
                <input
                  class="appearance-none block w-full bg-grey-lighter text-grey-darker border border-grey-lighter rounded py-3 px-4 mb-3"
                  id="grid-password"
                  type="text"
                  placeholder="¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦"
                  name="english"
                  required
                />
              </div>
            </div>
            <div class="-mx-3 md:flex mb-6">
              <div class="md:w-full px-3">
                <label
                  class="block uppercase tracking-wide text-blue inline-block text-xs font-bold mb-2 hover:bg-grey-lighter"
                  for="grid-password"
                >
                  Croatian</label
                >
                <input
                  class="appearance-none block w-full bg-grey-lighter text-grey-darker border border-grey-lighter rounded py-3 px-4 mb-3"
                  id="grid-password"
                  type="text"
                  placeholder="¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦ ¦"
                  name="croatian"
                  required
                />
              </div>
            </div>
            <div class="-mx-3 md:flex mb-2">
              <div class="md:w-1/2 px-3 mb-6 md:mb-0">
                <input
                  type="submit"
                  class="bg-blue hover:bg-green text-white font-semibold py-2 px-4 border border-grey-light rounded shadow"
                  value="Submit"
                />
                <button
                  class="bg-purple hover:bg-red text-black font-bold py-2 px-4 rounded inline-flex items-center"
                  onClick="functions()"
                  type="button"
                >
                  <span>Clear Everything</span>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div
        class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4 flex flex-col my-2 wb eo relative"
      >
        <pre id="result"></pre>
        <button id="copyButton" class="absolute bottom-0 right-0 m-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="icon icon-tabler icon-tabler-copy"
            width="44"
            height="44"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="black"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path
              d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z"
            />
            <path
              d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1"
            />
          </svg>
        </button>
      </div>
    </div>

    <script>
      let jsonArray = [];
      let localStorageTranslations = localStorage.getItem("translations");

      const form = document.getElementById("myForm");
      const result = document.getElementById("result");

      if (localStorageTranslations) {
        jsonArray = JSON.parse(localStorageTranslations);
        setResult();
      }

      form.addEventListener("submit", onFormSubmit, false);

      function onFormSubmit(e) {
        e.preventDefault();
        const formData = new FormData(form);
        const englishWord = formData.get("english");
        const croatianWord = formData.get("croatian");

        const obj = {
          english: englishWord,
          croatian: croatianWord,
        };

        jsonArray.push(obj);
        form.reset();
        form.english.focus();
        setResult();
      }

      function setResult() {
        let resultString = JSON.stringify(jsonArray);
        resultString = resultString.replace(/\,(?={)/g, ",\n");
        result.textContent = resultString;

        localStorage.setItem("translations", resultString);
      }

      function functions() {
        function clearArray() {
          jsonArray = [];
          result.textContent = "";
          localStorage.removeItem("translations");
        }

        if (jsonArray.length === 0) {
          swal("Error", "You have not entered any words", "error");
          return;
        }

        swal({
          title: "Are you sure?",
          text: "You won't be able to revert this!",
          type: "warning",
          showCancelButton: true,
          confirmButtonColor: "#3085d6",
          cancelButtonColor: "#d33",
          confirmButtonText: "Yes, delete it!",
        }).then((result) => {
          if (result.value) {
            clearArray();
            swal("Deleted!", "Everything has been deleted.", "success");
          }
        });
      }

      // Attach copy button to result element
      // Create the element first
      const copyButton = document.getElementById("copyButton");
      copyButton.addEventListener("click", copyToClipboard);

      function copyToClipboard() {
        // Make this without an text area
        const textArea = document.createElement("textarea");
        textArea.value = result.textContent;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand("copy");
        document.body.removeChild(textArea);

        swal(
          "Copied!",
          "The JSON has been copied to your clipboard.",
          "success"
        );
      }
    </script>
  </body>
</html>
